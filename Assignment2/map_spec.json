{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Metropolitan Melbourne Train Stations — Annual Passengers (2024–25)",
    "anchor": "start",
    "fontSize": 20,
    "fontWeight": "bold"
  },
  "width": 800,
  "height": 650,
  "projection": {"type": "mercator"},
  "layer": [
    {
      "data": {
        "url": "data/output.json",
        "format": {"type": "topojson", "feature": "vic_localities"}
      },
      "mark": {"type": "geoshape", "fill": "#f7f7f7", "stroke": "#c9c9c9", "strokeWidth": 0.75}
    },
    {
      "data": {
        "url": "data/output.json",
        "format": {"type": "topojson", "feature": "train_lines_only_noR"}
      },
      "mark": {"type": "geoshape", "fill": null, "stroke": "#404040", "strokeWidth": 1.2}
    },
    {
      "data": {"url": "data/annual_metropolitan_train_station_entries_fy_2024_2025.csv"},
      "transform": [
        {"calculate": "toNumber(datum.Stop_long)", "as": "lon"},
        {"calculate": "toNumber(datum.Stop_lat)",  "as": "lat"},
        {"calculate": "toNumber(datum.Pax_annual)", "as": "pax"},
        {"filter": "isFinite(datum.lon) && isFinite(datum.lat) && isFinite(datum.pax) && datum.pax > 0"}
      ],
      "mark": {"type": "circle", "opacity": 0.9, "size": 64, "stroke": "white", "strokeWidth": 0.5},
      "encoding": {
        "longitude": {"field": "lon", "type": "quantitative"},
        "latitude":  {"field": "lat", "type": "quantitative"},
        "color": {
          "field": "pax",
          "type": "quantitative",
          "title": "Log (Annual Passengers)",
          
          "scale": {"scheme": "purples", "type": "log", "domain": [1000, 25000000]},
          "legend": {
            "orient": "none",
            "legendX": 510,
            "legendY": 30,
            "direction": "vertical",
            "format": "~s",
            "gradientLength": 140,
            "gradientThickness": 14,
            "titleFontSize": 12,
            "labelFontSize": 11,
            "titleAlign": "center"
          }
        },
        "tooltip": [
          {"field": "Stop_name", "title": "Station"},
          {"field": "Pax_annual", "title": "Annual", "format": ","},
          {"field": "Pax_AM_peak", "title": "AM Peak", "format": ","},
          {"field": "Pax_PM_peak", "title": "PM Peak", "format": ","}
        ]
      }
    }
  ],
 "config": {
  "view": {"stroke": null, "continuousWidth": 800, "continuousHeight": 650},
  "legend": {"offset": 0}
},
"padding": {"left": 5, "top": 5, "right": 5, "bottom": 5}

}
